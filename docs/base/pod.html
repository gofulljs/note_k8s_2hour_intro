
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Pod(容器集) · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="gofulljs">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-back-to-top-button/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search-plus/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-code/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-anchor-navigation-ex/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-disqus/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../styles/website.css">
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="deployment_replicaset.html" />
    
    
    <link rel="prev" href="env_k3s.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Kubernetes 课程导读
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="./">
            
                <a href="./">
            
                    
                    Kubernetes 基础
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="intro.html">
            
                <a href="intro.html">
            
                    
                    Kubernetes 简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="architecture.html">
            
                <a href="architecture.html">
            
                    
                    Kubernetes 架构
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="minikube.html">
            
                <a href="minikube.html">
            
                    
                    安装 Minikube
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="env_k3s.html">
            
                <a href="env_k3s.html">
            
                    
                    使用 K3s 快速搭建集群
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.2.5" data-path="pod.html">
            
                <a href="pod.html">
            
                    
                    Pod(容器集)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="deployment_replicaset.html">
            
                <a href="deployment_replicaset.html">
            
                    
                    Deployment(部署)与 ReplicaSet(副本集)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7" data-path="service.html">
            
                <a href="service.html">
            
                    
                    Service(服务)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8" data-path="namespace.html">
            
                <a href="namespace.html">
            
                    
                    Namespace(命名空间)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9" data-path="declaration.html">
            
                <a href="declaration.html">
            
                    
                    声明式对象配置
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.10" data-path="canary.html">
            
                <a href="canary.html">
            
                    
                    金丝雀发布
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../runapp/">
            
                <a href="../runapp/">
            
                    
                    运行有状态的应用
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../runapp/create_mysql.html">
            
                <a href="../runapp/create_mysql.html">
            
                    
                    创建 MySQL 数据库
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../runapp/configmap_secret.html">
            
                <a href="../runapp/configmap_secret.html">
            
                    
                    ConfigMap 与 Secret
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../runapp/volume.html">
            
                <a href="../runapp/volume.html">
            
                    
                    卷(Volume)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../runapp/ev.html">
            
                <a href="../runapp/ev.html">
            
                    
                    临时卷(EV)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../runapp/persistent_volume.html">
            
                <a href="../runapp/persistent_volume.html">
            
                    
                    持久卷(PV)与持久卷声明(PVC)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="../runapp/storage_class.html">
            
                <a href="../runapp/storage_class.html">
            
                    
                    存储类(StorageClass)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="../runapp/stateful_set.html">
            
                <a href="../runapp/stateful_set.html">
            
                    
                    StatefulSet(有状态应用集)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8" data-path="../runapp/headless_service.html">
            
                <a href="../runapp/headless_service.html">
            
                    
                    Headless Service(无头服务)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9" data-path="../runapp/mysql_replicate.html">
            
                <a href="../runapp/mysql_replicate.html">
            
                    
                    Mysql 主从复制
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.10" data-path="../runapp/port_forward.html">
            
                <a href="../runapp/port_forward.html">
            
                    
                    Port-forward 端口转发
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.11" data-path="../runapp/helm.html">
            
                <a href="../runapp/helm.html">
            
                    
                    Helm安装MySQL机群
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Pod(容器集)</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div class="search-plus" id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div id="anchor-navigation-ex-navbar"><i class="fa fa-navicon"></i><ul><li><span class="title-icon "></span><a href="#pod&#x5BB9;&#x5668;&#x96C6;"><b></b>Pod(&#x5BB9;&#x5668;&#x96C6;)</a></li><ul><li><span class="title-icon "></span><a href="#pod"><b></b>Pod</a></li><li><span class="title-icon "></span><a href="#&#x521B;&#x5EFA;&#x548C;&#x7BA1;&#x7406;-pod"><b></b>&#x521B;&#x5EFA;&#x548C;&#x7BA1;&#x7406; Pod</a></li><li><span class="title-icon "></span><a href="#&#x955C;&#x50CF;&#x52A0;&#x901F;"><b></b>&#x955C;&#x50CF;&#x52A0;&#x901F;</a></li><ul><li><span class="title-icon "></span><a href="#&#x5728;-k3s-&#x4E2D;&#x914D;&#x7F6E;&#x955C;&#x50CF;&#x4ED3;&#x5E93;"><b></b>&#x5728; K3s &#x4E2D;&#x914D;&#x7F6E;&#x955C;&#x50CF;&#x4ED3;&#x5E93;</a></li></ul><li><span class="title-icon "></span><a href="#&#x5BB9;&#x5668;&#x4E0E;&#x955C;&#x50CF;"><b></b>&#x5BB9;&#x5668;&#x4E0E;&#x955C;&#x50CF;</a></li><ul><li><span class="title-icon "></span><a href="#&#x5BB9;&#x5668;&#x8FD0;&#x884C;&#x65F6;&#x63A5;&#x53E3;&#xFF08;cri&#xFF09;"><b></b>&#x5BB9;&#x5668;&#x8FD0;&#x884C;&#x65F6;&#x63A5;&#x53E3;&#xFF08;CRI&#xFF09;</a></li></ul></ul></ul></div><a href="#pod&#x5BB9;&#x5668;&#x96C6;" id="anchorNavigationExGoTop"><i class="fa fa-arrow-up"></i></a><h1 id="pod&#x5BB9;&#x5668;&#x96C6;"><a name="pod&#x5BB9;&#x5668;&#x96C6;" class="anchor-navigation-ex-anchor" href="#pod&#x5BB9;&#x5668;&#x96C6;"><i class="fa fa-link" aria-hidden="true"></i></a>Pod(&#x5BB9;&#x5668;&#x96C6;)</h1>
<h2 id="pod"><a name="pod" class="anchor-navigation-ex-anchor" href="#pod"><i class="fa fa-link" aria-hidden="true"></i></a>Pod</h2>
<p><strong>Pod</strong> &#x662F;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x5BB9;&#x5668;&#x7684;&#x5BB9;&#x5668;&#x7EC4;&#xFF0C;&#x662F; Kubernetes &#x4E2D;&#x521B;&#x5EFA;&#x548C;&#x7BA1;&#x7406;&#x7684;&#x6700;&#x5C0F;&#x5BF9;&#x8C61;&#x3002;
Pod &#x6709;&#x4EE5;&#x4E0B;&#x7279;&#x70B9;&#xFF1A;</p>
<ul>
<li>Pod &#x662F; kubernetes &#x4E2D; <label style="color:red">&#x6700;&#x5C0F;&#x7684;&#x8C03;&#x5EA6;&#x5355;&#x4F4D;</label>&#xFF08;&#x539F;&#x5B50;&#x5355;&#x5143;&#xFF09;&#xFF0C;Kubernetes &#x76F4;&#x63A5;&#x7BA1;&#x7406; Pod &#x800C;&#x4E0D;&#x662F;&#x5BB9;&#x5668;&#x3002;</li>
<li>&#x540C;&#x4E00;&#x4E2A; Pod &#x4E2D;&#x7684;&#x5BB9;&#x5668;&#x603B;&#x662F;&#x4F1A;&#x88AB;&#x81EA;&#x52A8;&#x5B89;&#x6392;&#x5230;&#x96C6;&#x7FA4;&#x4E2D;&#x7684; <label style="color:red">&#x540C;&#x4E00;&#x8282;&#x70B9;</label>&#xFF08;&#x7269;&#x7406;&#x673A;&#x6216;&#x865A;&#x62DF;&#x673A;&#xFF09;&#x4E0A;&#xFF0C;&#x5E76;&#x4E14;<label style="color:red">&#x4E00;&#x8D77;&#x8C03;&#x5EA6;&#x3002;</label></li>
<li>Pod &#x53EF;&#x4EE5;&#x7406;&#x89E3;&#x4E3A;&#x8FD0;&#x884C;&#x7279;&#x5B9A;&#x5E94;&#x7528;&#x7684;&#x201C;&#x903B;&#x8F91;&#x4E3B;&#x673A;&#x201D;&#xFF0C;&#x8FD9;&#x4E9B;&#x5BB9;&#x5668;&#x5171;&#x4EAB;&#x5B58;&#x50A8;&#x3001;&#x7F51;&#x7EDC;&#x548C;&#x914D;&#x7F6E;&#x58F0;&#x660E;(&#x5982;&#x8D44;&#x6E90;&#x9650;&#x5236;)&#x3002;</li>
<li>&#x6BCF;&#x4E2A; Pod &#x6709;&#x552F;&#x4E00;&#x7684; IP &#x5730;&#x5740;&#x3002; <label style="color:red">IP &#x5730;&#x5740;&#x5206;&#x914D;&#x7ED9; Pod</label>&#xFF0C;&#x5728;&#x540C;&#x4E00;&#x4E2A; Pod &#x5185;&#xFF0C;&#x6240;&#x6709;&#x5BB9;&#x5668;&#x5171;&#x4EAB;&#x4E00;&#x4E2A; IP &#x5730;&#x5740;&#x548C;&#x7AEF;&#x53E3;&#x7A7A;&#x95F4;&#xFF0C;Pod &#x5185;&#x7684;&#x5BB9;&#x5668;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; localhost &#x4E92;&#x76F8;&#x901A;&#x4FE1;&#x3002;</li>
</ul>
<hr>
<p>&#x4F8B;&#x5982;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x6709;&#x4E00;&#x4E2A;&#x5BB9;&#x5668;&#xFF0C;&#x4E3A;&#x5171;&#x4EAB;&#x5377;&#x4E2D;&#x7684;&#x6587;&#x4EF6;&#x63D0;&#x4F9B; Web &#x670D;&#x52A1;&#x5668;&#x652F;&#x6301;&#xFF0C;&#x4EE5;&#x53CA;&#x4E00;&#x4E2A;&#x5355;&#x72EC;&#x7684; &quot;&#x8FB9;&#x8F66; (sidercar)&quot; &#x5BB9;&#x5668;&#x8D1F;&#x8D23;&#x4ECE;&#x8FDC;&#x7AEF;&#x66F4;&#x65B0;&#x8FD9;&#x4E9B;&#x6587;&#x4EF6;&#xFF0C;&#x5982;&#x4E0B;&#x56FE;&#x6240;&#x793A;&#xFF1A;</p>
<p><img src="imgs/image-4.png" alt="Alt text"></p>
<h2 id="&#x521B;&#x5EFA;&#x548C;&#x7BA1;&#x7406;-pod"><a name="&#x521B;&#x5EFA;&#x548C;&#x7BA1;&#x7406;-pod" class="anchor-navigation-ex-anchor" href="#&#x521B;&#x5EFA;&#x548C;&#x7BA1;&#x7406;-pod"><i class="fa fa-link" aria-hidden="true"></i></a>&#x521B;&#x5EFA;&#x548C;&#x7BA1;&#x7406; Pod</h2>
<pre><code class="lang-sh"><span class="hljs-comment"># &#x521B;&#x5EFA; mynginx pod &#x5E76;&#x4F7F;&#x7528;&#x5BB9;&#x5668;&#x955C;&#x50CF; nginx &#x7684; 1.22 &#x7248;&#x672C;</span>
kubectl run mynginx --image=nginx:1.22
<span class="hljs-comment"># &#x67E5;&#x770B;Pod</span>
kubectl get pod
<span class="hljs-comment"># &#x67E5;&#x770B;pod&#x65E5;&#x5FD7;</span>
kubectl logs <span class="hljs-_">-f</span> mynginx
<span class="hljs-comment"># &#x67E5;&#x770B;pod&#x63CF;&#x8FF0;&#x4FE1;&#x606F;</span>
kubectl describe pod mynginx
</code></pre>
<ul>
<li>&#x8BBF;&#x95EE; pod</li>
</ul>
<pre><code class="lang-sh"><span class="hljs-comment"># &#x67E5;&#x770B;Pod&#x8BE6;&#x7EC6;&#x4FE1;&#x606F;(&#x5305;&#x542B;IP&#x548C;&#x8FD0;&#x884C;&#x8282;&#x70B9;&#x4FE1;&#x606F;)</span>
$ kubectl get pod -owide
NAME      READY   STATUS    RESTARTS   AGE   IP          NODE                NOMINATED NODE   READINESS GATES
mynginx   1/1     Running   0          14m   10.42.2.5   k3d-demo-server-0   &lt;none&gt;           &lt;none&gt;
</code></pre>
<ul>
<li>&#x83B7;&#x53D6;&#x5230;&#x8BBF;&#x95EE;&#x7684;&#x5185;&#x5BB9;</li>
</ul>
<pre><code class="lang-sh"><span class="hljs-comment"># &#x4F7F;&#x7528;Pod&#x7684;ip+pod&#x91CC;&#x9762;&#x8FD0;&#x884C;&#x5BB9;&#x5668;&#x7684;&#x7AEF;&#x53E3;</span>
curl 10.42.2.5
<span class="hljs-comment"># &#x6216;&#x4F7F;&#x7528; wget</span>
wget -qO- http://10.42.2.5
</code></pre>
<ul>
<li>&#x5BB9;&#x5668;&#x4E2D;&#x6267;&#x884C;&#x547D;&#x4EE4;</li>
</ul>
<pre><code class="lang-sh"><span class="hljs-comment">#&#x5728;&#x5BB9;&#x5668;&#x4E2D;&#x6267;&#x884C;</span>
kubectl <span class="hljs-built_in">exec</span> mynginx -it -- /bin/bash

<span class="hljs-comment">#&#x8FDB;&#x5165;&#x5BB9;&#x5668;&#x8BBF;&#x95EE;&#x81EA;&#x8EAB;</span>
curl localhost
</code></pre>
<ul>
<li>&#x8FD0;&#x884C; pod&#xFF0C;&#x9000;&#x51FA;&#x540E;&#x81EA;&#x52A8;&#x5220;&#x9664;&#x5BB9;&#x5668;</li>
</ul>
<pre><code class="lang-sh"><span class="hljs-comment"># &#x8FD0;&#x884C; busybox &#x5BB9;&#x5668;</span>
kubectl run my-busybox --image=busybox -ti --rm
<span class="hljs-comment"># ping &#x4E3B;&#x673A;ip</span>
ping {{host_ip}}
<span class="hljs-comment"># &#x9000;&#x51FA;</span>
<span class="hljs-built_in">exit</span>
<span class="hljs-comment"># &#x53D1;&#x73B0; pod &#x5DF2;&#x4E0D;&#x5B58;&#x5728;</span>
kubectl get pod
</code></pre>
<ul>
<li>&#x5220;&#x9664;&#x5BB9;&#x5668;</li>
</ul>
<pre><code class="lang-sh"><span class="hljs-comment"># &#x5220;&#x9664; mynginx</span>
kubectl delete pod mynginx

<span class="hljs-comment"># &#x5F3A;&#x5236;&#x5220;&#x9664;</span>
kubectl delete pod mynginx --force
</code></pre>
<ul>
<li>watch &#x6A21;&#x5F0F;</li>
</ul>
<pre><code class="lang-sh">kubectl get pod --watch
</code></pre>
<p><img src="imgs/image-5.png" alt="Alt text"></p>
<h2 id="&#x955C;&#x50CF;&#x52A0;&#x901F;"><a name="&#x955C;&#x50CF;&#x52A0;&#x901F;" class="anchor-navigation-ex-anchor" href="#&#x955C;&#x50CF;&#x52A0;&#x901F;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x955C;&#x50CF;&#x52A0;&#x901F;</h2>
<p>&#x7531;&#x4E8E; kubernetes &#x4ECE;<code>V1.24</code>&#x7248;&#x672C;&#x5F00;&#x59CB;&#x9ED8;&#x8BA4;&#x4F7F;&#x7528;<code>containerd</code>&#xFF0C;&#x9700;&#x8981;&#x4FEE;&#x6539;<code>containerd</code>&#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;&#x624D;&#x80FD;&#x8BA9; Pod &#x7684;&#x955C;&#x50CF;&#x4F7F;&#x7528;&#x955C;&#x50CF;&#x52A0;&#x901F;&#x5668;&#x3002;
&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x8DEF;&#x5F84;&#x4E00;&#x822C;&#x4E3A;<code>/etc/containerd/config.toml</code>&#xFF0C;&#x8BE6;&#x89C1;<a href="https://help.aliyun.com/document_detail/60750.html" target="_blank">&#x963F;&#x91CC;&#x4E91;&#x955C;&#x50CF;&#x52A0;&#x901F;</a>&#x3002;</p>
<h3 id="&#x5728;-k3s-&#x4E2D;&#x914D;&#x7F6E;&#x955C;&#x50CF;&#x4ED3;&#x5E93;"><a name="&#x5728;-k3s-&#x4E2D;&#x914D;&#x7F6E;&#x955C;&#x50CF;&#x4ED3;&#x5E93;" class="anchor-navigation-ex-anchor" href="#&#x5728;-k3s-&#x4E2D;&#x914D;&#x7F6E;&#x955C;&#x50CF;&#x4ED3;&#x5E93;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5728; K3s &#x4E2D;&#x914D;&#x7F6E;&#x955C;&#x50CF;&#x4ED3;&#x5E93;</h3>
<p>K3s &#x4F1A;&#x81EA;&#x52A8;&#x751F;&#x6210; containerd &#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;<code>/var/lib/rancher/k3s/agent/etc/containerd/config.toml</code>,&#x4E0D;&#x8981;&#x76F4;&#x63A5;&#x4FEE;&#x6539;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#xFF0C;k3s &#x91CD;&#x542F;&#x540E;&#x4FEE;&#x6539;&#x4F1A;&#x4E22;&#x5931;&#x3002;</p>
<p>&#x4E3A;&#x4E86;&#x7B80;&#x5316;&#x914D;&#x7F6E;&#xFF0C;K3s &#x901A;&#x8FC7;<code>/etc/rancher/k3s/registries.yaml</code>&#x6587;&#x4EF6;&#x6765;&#x914D;&#x7F6E;&#x955C;&#x50CF;&#x4ED3;&#x5E93;&#xFF0C;K3s &#x4F1A;&#x5728;&#x542F;&#x52A8;&#x65F6;&#x68C0;&#x67E5;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x662F;&#x5426;&#x5B58;&#x5728;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5728;&#x6BCF;&#x4E2A;&#x8282;&#x70B9;&#x4E0A;&#x65B0;&#x5EFA;<code>/etc/rancher/k3s/registries.yaml</code>&#x6587;&#x4EF6;&#xFF0C;&#x914D;&#x7F6E;&#x5185;&#x5BB9;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code class="lang-sh">mirrors:
  docker.io:
    endpoint:
      - <span class="hljs-string">&quot;https://fsp2sfpr.mirror.aliyuncs.com/&quot;</span>
</code></pre>
<p>&#x91CD;&#x542F;&#x6BCF;&#x4E2A;&#x8282;&#x70B9;</p>
<pre><code class="lang-sh">systemctl restart k3s
systemctl restart k3s-agent
</code></pre>
<p>&#x67E5;&#x770B;&#x914D;&#x7F6E;&#x662F;&#x5426;&#x751F;&#x6548;&#x3002;</p>
<pre><code class="lang-sh">cat /var/lib/rancher/k3s/agent/etc/containerd/config.toml
</code></pre>
<p><img src="imgs/image-6.png" alt="Alt text"></p>
<h2 id="&#x5BB9;&#x5668;&#x4E0E;&#x955C;&#x50CF;"><a name="&#x5BB9;&#x5668;&#x4E0E;&#x955C;&#x50CF;" class="anchor-navigation-ex-anchor" href="#&#x5BB9;&#x5668;&#x4E0E;&#x955C;&#x50CF;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5BB9;&#x5668;&#x4E0E;&#x955C;&#x50CF;</h2>
<h3 id="&#x5BB9;&#x5668;&#x8FD0;&#x884C;&#x65F6;&#x63A5;&#x53E3;&#xFF08;cri&#xFF09;"><a name="&#x5BB9;&#x5668;&#x8FD0;&#x884C;&#x65F6;&#x63A5;&#x53E3;&#xFF08;cri&#xFF09;" class="anchor-navigation-ex-anchor" href="#&#x5BB9;&#x5668;&#x8FD0;&#x884C;&#x65F6;&#x63A5;&#x53E3;&#xFF08;cri&#xFF09;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5BB9;&#x5668;&#x8FD0;&#x884C;&#x65F6;&#x63A5;&#x53E3;&#xFF08;CRI&#xFF09;</h3>
<p>Kubelet &#x8FD0;&#x884C;&#x5728;&#x6BCF;&#x4E2A;&#x8282;&#x70B9;(Node)&#x4E0A;,&#x7528;&#x4E8E;&#x7BA1;&#x7406;&#x548C;&#x7EF4;&#x62A4; Pod &#x548C;&#x5BB9;&#x5668;&#x7684;&#x72B6;&#x6001;&#x3002;
&#x5BB9;&#x5668;&#x8FD0;&#x884C;&#x65F6;&#x63A5;&#x53E3;&#xFF08;CRI&#xFF09;&#x662F; kubelet &#x548C;&#x5BB9;&#x5668;&#x8FD0;&#x884C;&#x65F6;&#x4E4B;&#x95F4;&#x901A;&#x4FE1;&#x7684;&#x4E3B;&#x8981;&#x534F;&#x8BAE;&#x3002;&#x5B83;&#x5C06; Kubelet &#x4E0E;&#x5BB9;&#x5668;&#x8FD0;&#x884C;&#x65F6;&#x89E3;&#x8026;&#xFF0C;&#x7406;&#x8BBA;&#x4E0A;&#xFF0C;&#x5B9E;&#x73B0;&#x4E86; CRI &#x63A5;&#x53E3;&#x7684;&#x5BB9;&#x5668;&#x5F15;&#x64CE;&#xFF0C;&#x90FD;&#x53EF;&#x4EE5;&#x4F5C;&#x4E3A; kubernetes &#x7684;&#x5BB9;&#x5668;&#x8FD0;&#x884C;&#x65F6;&#x3002;</p>
<p class="r">
Docker&#x6CA1;&#x6709;&#x5B9E;&#x73B0;&#xFF08;CRI&#xFF09;&#x63A5;&#x53E3;&#xFF0C;Kubernetes&#x4F7F;&#x7528;dockershim&#x6765;&#x517C;&#x5BB9;docker&#x3002;<br>
&#x81EA;V1.24&#x7248;&#x672C;&#x8D77;&#xFF0C;Dockershim &#x5DF2;&#x4ECE; Kubernetes &#x9879;&#x76EE;&#x4E2D;&#x79FB;&#x9664;&#x3002;
</p>

<p><code>crictl</code>&#x662F;&#x4E00;&#x4E2A;&#x517C;&#x5BB9; CRI &#x7684;&#x5BB9;&#x5668;&#x8FD0;&#x884C;&#x65F6;&#x547D;&#x4EE4;&#xFF0C;&#x4ED6;&#x7684;&#x7528;&#x6CD5;&#x8DDF; <code>docker</code> &#x547D;&#x4EE4;&#x4E00;&#x6837;&#xFF0C;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x68C0;&#x67E5;&#x548C;&#x8C03;&#x8BD5;&#x5E95;&#x5C42;&#x7684;&#x8FD0;&#x884C;&#x65F6;&#x5BB9;&#x5668;&#x3002;</p>
<ul>
<li>&#x67E5;&#x770B;&#x5BB9;&#x5668;&#x548C;&#x955C;&#x50CF;</li>
</ul>
<pre><code class="lang-sh"><span class="hljs-comment"># &#x67E5;&#x770B;&#x5BB9;&#x5668;</span>
$ crictl ps
CONTAINER           IMAGE               CREATED             STATE               NAME                ATTEMPT             POD ID              POD
47aaa00baba1e       0f8498f13f3ad       7 hours ago         Running             nginx               0                   ad79f75bc4e04       nginx-deploy-5964889c54-fkd8t
2c47bdd5aaa26       ead0a4a53df89       3 days ago          Running             coredns             10                  05fbcfa8067b8       coredns-77ccd57875-rf6s4
f1bcf4785b184       af74bd845c4a8       3 days ago          Running             lb-tcp-443          1                   d793ffcccf6fe       svclb-traefik-c090484e-cnsgm
2cc1af75acf27       af74bd845c4a8       3 days ago          Running             lb-tcp-80           1                   d793ffcccf6fe       svclb-traefik-c090484e-cnsgm
<span class="hljs-comment"># &#x67E5;&#x770B;&#x955C;&#x50CF;</span>
$ crictl images
IMAGE                                        TAG                    IMAGE ID            SIZE
docker.io/library/nginx                      1.22                   0f8498f13f3ad       57MB
docker.io/library/nginx                      1.23                   a7be6198544f0       57MB
docker.io/rancher/klipper-helm               v0.8.0-build20230510   6f42df210d7fa       95MB
docker.io/rancher/klipper-lb                 v0.4.4                 af74bd845c4a8       4.92MB
docker.io/rancher/mirrored-coredns-coredns   1.10.1                 ead0a4a53df89       16.2MB
docker.io/rancher/mirrored-pause             3.6                    6270bb605e12e       301kB
</code></pre>
<ul>
<li>crictl &#x547D;&#x4EE4;</li>
</ul>
<p>&#x547D;&#x4EE4;&#x76F8;&#x5BF9; docker &#x5C11;&#x4E00;&#x4E9B;&#xFF0C;&#x6BD4;&#x5982;&#x65E0;&#x6CD5;&#x5BFC;&#x5165;&#x5BFC;&#x51FA;&#x955C;&#x50CF;</p>
<pre><code class="lang-sh">$ crictl -h
NAME:
   crictl - client <span class="hljs-keyword">for</span> CRI

USAGE:
   crictl [global options] <span class="hljs-built_in">command</span> [<span class="hljs-built_in">command</span> options] [arguments...]

VERSION:
   v1.26.0-rc.0-k3s1

COMMANDS:
   attach              Attach to a running container
   create              Create a new container
   <span class="hljs-built_in">exec</span>                Run a <span class="hljs-built_in">command</span> <span class="hljs-keyword">in</span> a running container
   version             Display runtime version information
   images, image, img  List images
   inspect             Display the status of one or more containers
   inspecti            Return the status of one or more images
   imagefsinfo         Return image filesystem info
   inspectp            Display the status of one or more pods
   logs                Fetch the logs of a container
   port-forward        Forward <span class="hljs-built_in">local</span> port to a pod
   ps                  List containers
   pull                Pull an image from a registry
   run                 Run a new container inside a sandbox
   runp                Run a new pod
   rm                  Remove one or more containers
   rmi                 Remove one or more images
   rmp                 Remove one or more pods
   pods                List pods
   start               Start one or more created containers
   info                Display information of the container runtime
   stop                Stop one or more running containers
   stopp               Stop one or more running pods
   update              Update one or more running containers
   config              Get and <span class="hljs-built_in">set</span> crictl client configuration options
   stats               List container(s) resource usage statistics
   statsp              List pod resource usage statistics
   completion          Output shell completion code
   checkpoint          Checkpoint one or more running containers
   <span class="hljs-built_in">help</span>, h             Shows a list of commands or <span class="hljs-built_in">help</span> <span class="hljs-keyword">for</span> one <span class="hljs-built_in">command</span>

GLOBAL OPTIONS:
   --config value, -c value            Location of the client config file. If not specified and the default does not exist, the program<span class="hljs-string">&apos;s directory is searched as well (default: &quot;/etc/crictl.yaml&quot;) [$CRI_CONFIG_FILE]
   --debug, -D                         Enable debug mode (default: false)
   --image-endpoint value, -i value    Endpoint of CRI image manager service (default: uses &apos;</span>runtime-endpoint<span class="hljs-string">&apos; setting) [$IMAGE_SERVICE_ENDPOINT]
   --runtime-endpoint value, -r value  Endpoint of CRI container runtime service (default: uses in order the first successful one of [unix:///run/k3s/containerd/containerd.sock unix:///var/run/dockershim.sock unix:///run/containerd/containerd.sock unix:///run/crio/crio.sock unix:///var/run/cri-dockerd.sock]). Default is now deprecated and the endpoint should be set instead. [$CONTAINER_RUNTIME_ENDPOINT]
   --timeout value, -t value           Timeout of connecting to the server in seconds (e.g. 2s, 20s.). 0 or less is set to default (default: 2s)
   --help, -h                          show help (default: false)
   --version, -v                       print the version (default: false)
</span></code></pre>
<p>&#x5728;&#x4E00;&#x4E9B;&#x5C40;&#x57DF;&#x7F51;&#x73AF;&#x5883;&#x4E0B;&#xFF0C;&#x6211;&#x4EEC;&#x6CA1;&#x6CD5;&#x901A;&#x8FC7;&#x4E92;&#x8054;&#x7F51;&#x62C9;&#x53D6;&#x955C;&#x50CF;&#xFF0C;&#x53EF;&#x4EE5;&#x624B;&#x52A8;&#x7684;&#x5BFC;&#x51FA;&#x3001;&#x5BFC;&#x5165;&#x955C;&#x50CF;&#x3002;
<code>crictl</code> &#x547D;&#x4EE4;&#x6CA1;&#x6709;&#x5BFC;&#x51FA;&#x3001;&#x5BFC;&#x5165;&#x955C;&#x50CF;&#x7684;&#x529F;&#x80FD;&#x3002;
&#x9700;&#x8981;&#x4F7F;&#x7528; <code>ctr</code> &#x547D;&#x4EE4;&#x5BFC;&#x51FA;&#x3001;&#x5BFC;&#x5165;&#x955C;&#x50CF;&#xFF0C;&#x5B83;&#x662F; <code>containerd</code> &#x7684;&#x547D;&#x4EE4;&#x884C;&#x63A5;&#x53E3;&#x3002;</p>
<pre><code class="lang-sh"><span class="hljs-comment"># &#x53EA;&#x9700;&#x8981;&#x638C;&#x63E1;&#x5BFC;&#x5165;&#x5BFC;&#x51FA;&#x955C;&#x50CF;&#x5373;&#x53EF;</span>
$ ctr -h
NAME:
   ctr -
        __
  _____/ /______
 / ___/ __/ ___/
/ /__/ /_/ /
\___/\__/_/

containerd CLI


USAGE:
   ctr [global options] <span class="hljs-built_in">command</span> [<span class="hljs-built_in">command</span> options] [arguments...]

VERSION:
   v1.7.1-k3s1

DESCRIPTION:

ctr is an unsupported debug and administrative client <span class="hljs-keyword">for</span> interacting
with the containerd daemon. Because it is unsupported, the commands,
options, and operations are not guaranteed to be backward compatible or
stable from release to release of the containerd project.

COMMANDS:
   plugins, plugin            Provides information about containerd plugins
   version                    Print the client and server versions
   containers, c, container   Manage containers
   content                    Manage content
   events, event              Display containerd events
   images, image, i           Manage images
   leases                     Manage leases
   namespaces, namespace, ns  Manage namespaces
   pprof                      Provide golang pprof outputs <span class="hljs-keyword">for</span> containerd
   run                        Run a container
   snapshots, snapshot        Manage snapshots
   tasks, t, task             Manage tasks
   install                    Install a new package
   oci                        OCI tools
   sandboxes, sandbox, sb, s  Manage sandboxes
   info                       Print the server info
   shim                       Interact with a shim directly
   <span class="hljs-built_in">help</span>, h                    Shows a list of commands or <span class="hljs-built_in">help</span> <span class="hljs-keyword">for</span> one <span class="hljs-built_in">command</span>

GLOBAL OPTIONS:
   --debug                      Enable debug output <span class="hljs-keyword">in</span> logs
   --address value, <span class="hljs-_">-a</span> value    Address <span class="hljs-keyword">for</span> containerd<span class="hljs-string">&apos;s GRPC server (default: &quot;/run/k3s/containerd/containerd.sock&quot;) [$CONTAINERD_ADDRESS]
   --timeout value              Total timeout for ctr commands (default: 0s)
   --connect-timeout value      Timeout for connecting to containerd (default: 0s)
   --namespace value, -n value  Namespace to use with commands (default: &quot;k8s.io&quot;) [$CONTAINERD_NAMESPACE]
   --help, -h                   show help
   --version, -v                print the version
</span></code></pre>
<hr>
<ul>
<li>&#x4ECE;<code>docker</code>&#x5BFC;&#x51FA;&#x955C;&#x50CF;&#x518D;&#x5BFC;&#x5165;&#x5230;<code>containerd</code>&#x4E2D;</li>
</ul>
<pre><code class="lang-sh">$ docker pull alpine:3.15
$ docker save alpine:3.15 &gt; alpine-3.15.tar
<span class="hljs-comment"># &#x5C06;tar&#x62F7;&#x8D1D;&#x5230;&#x5BF9;&#x5E94;k8s&#x4E3B;&#x673A;</span>

<span class="hljs-comment">#kubernetes&#x4F7F;&#x7528;&#x7684;&#x955C;&#x50CF;&#x90FD;&#x5728;k8s.io&#x547D;&#x540D;&#x7A7A;&#x95F4;&#x4E2D;, &#x9700;&#x8981;&#x5236;&#x5B9A;&#x5BF9;&#x5E94;&#x5E73;&#x53F0;&#xFF0C;&#x5982;linux/amd64</span>
$ ctr -n k8s.io images import alpine-3.15.tar --platform linux/amd64
unpacking docker.io/library/alpine:3.15 (sha256:69ba0f584ebec4ccf2ccf44817931f3facfb924380355466495274b2e273fe7b)...done

<span class="hljs-comment"># &#x53EF;&#x4EE5;&#x770B;&#x5230;&#x955C;&#x50CF;&#x5BFC;&#x5165;&#x4E86;</span>
$ crictl images
IMAGE                                        TAG                    IMAGE ID            SIZE
docker.io/library/alpine                     3.15                   d51a1e6a80db9       5.87MB
&#x3002;&#x3002;&#x3002;
</code></pre>
<ul>
<li>&#x4ECE;<code>containerd</code>&#x5BFC;&#x51FA;&#x3001;&#x5BFC;&#x5165;&#x955C;&#x50CF;</li>
</ul>
<pre><code class="lang-sh"><span class="hljs-comment">#&#x5BFC;&#x51FA;&#x955C;&#x50CF;</span>
ctr -n k8s.io images <span class="hljs-built_in">export</span> alpine.tar docker.io/library/alpine:3.15 --platform linux/amd64
</code></pre>
<p>&#x53C2;&#x8003;&#x6587;&#x6863;&#xFF1A;<br><a href="https://kubernetes.io/zh-cn/docs/concepts/workloads/pods/" target="_blank">https://kubernetes.io/zh-cn/docs/concepts/workloads/pods/</a>
<a href="https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands" target="_blank">https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands</a>
<a href="https://kubernetes.io/zh-cn/docs/tasks/debug/debug-cluster/crictl/" target="_blank">https://kubernetes.io/zh-cn/docs/tasks/debug/debug-cluster/crictl/</a>
<a href="https://docs.k3s.io/installation/private-registry" target="_blank">https://docs.k3s.io/installation/private-registry</a></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="env_k3s.html" class="navigation navigation-prev " aria-label="Previous page: 使用 K3s 快速搭建集群">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="deployment_replicaset.html" class="navigation navigation-next " aria-label="Next page: Deployment(部署)与 ReplicaSet(副本集)">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Pod(容器集)","level":"1.2.5","depth":2,"next":{"title":"Deployment(部署)与 ReplicaSet(副本集)","level":"1.2.6","depth":2,"path":"base/deployment_replicaset.md","ref":"base/deployment_replicaset.md","articles":[]},"previous":{"title":"使用 K3s 快速搭建集群","level":"1.2.4","depth":2,"path":"base/env_k3s.md","ref":"base/env_k3s.md","articles":[]},"dir":"ltr"},"config":{"plugins":["back-to-top-button","-lunr","-search","search-plus","a-import","code","anchor-navigation-ex","ga","3-ba","github","disqus"],"styles":{"website":"styles/website.css"},"pluginsConfig":{"disqus":{"useIdentifier":false,"shortName":"gopher-1"},"github":{"url":"https://github.com/gofulljs"},"code":{"copyButtons":false},"a-import":{},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"anchor-navigation-ex":{"showLevelIcon":false,"mode":"float","pageTop":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"showLevel":false,"tocLevel1Icon":"fa fa-hand-o-right","tocLevel2Icon":"fa fa-hand-o-right","tocLevel3Icon":"fa fa-hand-o-right","showGoTop":true,"printLog":false,"multipleH1":false,"multipleH2":false,"associatedWithSummary":true,"multipleH3":false,"float":{"floatIcon":"fa fa-navicon","level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"multipleH4":false},"back-to-top-button":{},"3-ba":{"configuration":"auto","token":"4c1823e87df49c9e304623b546c910fd"},"ga":{"configuration":"auto","token":"G-VMFJ3KGT9"},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"search-plus":{}},"theme":"default","author":"gofulljs","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"gitbook":"*"},"file":{"path":"base/pod.md","mtime":"2023-10-26T08:19:08.564Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2023-10-26T08:23:17.262Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-back-to-top-button/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/jquery.mark.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-code/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-3-ba/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/URI.js/1.16.1/URI.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-disqus/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

